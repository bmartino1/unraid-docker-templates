<?xml version="1.0"?>
<Container version="2">
  <Name>dbrepair</Name>
  <Repository>bmmbmm01/plex-dbrepair</Repository>
  <Registry>https://hub.docker.com/r/bmmbmm01/plex-dbrepair</Registry>
  <Network>bridge</Network>
  <MyIP/>
  <Shell>sh</Shell>
  <Privileged>false</Privileged>
  <Support>https://forums.unraid.net/topic/196453-support-plex-db-repair-docker/</Support>
  <Project>https://github.com/bmartino1/plex-dbrepair-docker</Project>
  <ReadMe>https://github.com/ChuckPa/DBRepair/blob/master/README.md</ReadMe>
  <Overview>You will mount the Plex database directory into this container&#13;
&#13;
(usually something like /mnt/user/appdata/plex/Library/Application Support/Plex Media Server/Plug-in Support/Databases)&#13;
&#13;
The script runs once automatically and repairs the Plex database, then exits / stops the container.&#13;
&#13;
No Plex docker or process should be running while repair is happening!&#13;
Open the console and run `top` to confirm activity.&#13;
</Overview>
  <Category>Tools: MediaApp:Other</Category>
  <WebUI/>
  <TemplateURL/>
  <Icon>https://raw.githubusercontent.com/linuxserver/docker-templates/master/linuxserver.io/img/plex-logo.png</Icon>
  <ExtraParams>--hostname dbrepair</ExtraParams>
  <PostArgs/>
  <CPUset/>
  <DateInstalled>1768192874</DateInstalled>
  <DonateText/>
  <DonateLink/>
  <Requires>YOU ARE ULTIMATELY RESPONSIBLE FOR YOUR DATA! PLEX MUST BE OFF! You must mount the Plex DB folder.</Requires>

  <Config Name="Plex Database Folder"
          Target="/plexdb"
          Default="/mnt/user/appdata/plex/Library/Application Support/Plex Media Server/Plug-in Support/Databases"
          Mode="rw"
          Description="Path to the Plex database directory containing com.plexapp.plugins.library.db"
          Type="Path"
          Display="always"
          Required="true"
          Mask="false">/mnt/user/appdata/plex/Library/Application Support/Plex Media Server/Plug-in Support/Databases</Config>

  <Config Name="Logs Path"
          Target="/logs"
          Default="/mnt/user/appdata/plexrepair/logs"
          Mode="rw"
          Description="DBRepair log output directory"
          Type="Path"
          Display="always"
          Required="false"
          Mask="false">/mnt/user/appdata/plexrepair/logs</Config>

  <Config Name="HEARTBEAT_INTERVAL"
          Target="HEARTBEAT_INTERVAL"
          Default="300"
          Mode=""
          Description="Seconds between heartbeat messages while DBRepair is running"
          Type="Variable"
          Display="always"
          Required="true"
          Mask="false">180</Config>

  <Config Name="DBREPAIR_MODE"
          Target="DBREPAIR_MODE"
          Default="automatic"
          Mode=""
          Description="Default: automatic&#13;&#10;
Value&#9;Menu #&#9;Action&#13;&#10;
automatic&#9;2&#9;Check + Repair/Optimize + Reindex&#13;&#10;
check&#9;3&#9;Integrity check only&#13;&#10;
vacuum&#9;4&#9;Vacuum database&#13;&#10;
repair&#9;5&#9;Repair / Optimize&#13;&#10;
reindex&#9;6&#9;Rebuild indexes"
          Type="Variable"
          Display="always"
          Required="false"
          Mask="false">automatic</Config>

  <Config Name="SHOW_LOG"
          Target="SHOW_LOG"
          Default="true"
          Mode=""
          Description="Show DBRepair script output in Docker logs"
          Type="Variable"
          Display="always"
          Required="true"
          Mask="false">true</Config>

  <Config Name="DBREPAIR_UPDATE"
          Target="DBREPAIR_UPDATE"
          Default="true"
          Mode=""
          Description="Check for DBRepair script updates on start"
          Type="Variable"
          Display="always"
          Required="true"
          Mask="false">false</Config>

  <Config Name="PLEX_MATCH_REGEX"
          Target="PLEX_MATCH_REGEX"
          Default="Plex Media Server"
          Mode=""
          Description="Regex used to identify Plex containers/processes"
          Type="Variable"
          Display="advanced-hide"
          Required="true"
          Mask="false">Plex Media Server</Config>

  <Config Name="EXCLUDE_CONTAINER_NAMES"
          Target="EXCLUDE_CONTAINER_NAMES"
          Default="dbrepair,plex-dbrepair"
          Mode=""
          Description="Container names to exclude from shutdown"
          Type="Variable"
          Display="always"
          Required="true"
          Mask="false">dbrepair,plex-dbrepair</Config>

  <Config Name="ALLOW_PLEX_KILL"
          Target="ALLOW_PLEX_KILL"
          Default="true"
          Mode=""
          Description="Allow DBRepair to stop Plex containers"
          Type="Variable"
          Display="always"
          Required="true"
          Mask="false">true</Config>

  <Config Name="KILL_STRAY_PLEX_PROCESSES"
          Target="KILL_STRAY_PLEX_PROCESSES"
          Default="true"
          Mode=""
          Description="Kill stray Plex processes outside Docker"
          Type="Variable"
          Display="always"
          Required="true"
          Mask="false">false</Config>

  <Config Name="EXCLUDE_IMAGE_REGEX"
          Target="EXCLUDE_IMAGE_REGEX"
          Default="plex-dbrepair"
          Mode=""
          Description="Image regex to avoid killing self"
          Type="Variable"
          Display="advanced-hide"
          Required="true"
          Mask="false">plex-dbrepair</Config>

  <Config Name="Docker Run Socket"
          Target="/var/run/docker.sock"
          Default="/var/run/docker.sock"
          Mode="rw"
          Description="Required to manage Plex containers from Unraid"
          Type="Path"
          Display="advanced-hide"
          Required="true"
          Mask="false">/var/run/docker.sock</Config>

  <TailscaleStateDir/>
</Container>
